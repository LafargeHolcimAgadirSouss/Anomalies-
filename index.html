<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Affichage des anomalies</title>
    <style>
        .anomalie {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: #f9f9f9;
        }
        .anomalie img {
            max-width: 300px;
            height: auto;
            display: block;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<h2>Liste des anomalies</h2>
<div id="content"></div>

<script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT_C2LQs5q5x3vlCnJYJhZnwHC31sEPMSP21XTw2fxszMe8no2Q2oLM3Fe7IqvftPI3_2-JlITASVlM/pub?gid=1768493748&single=true&output=csv';

    fetch(sheetURL)
        .then(response => response.text())
        .then(csv => {
            const rows = csv.trim().split('\n');
            const contentDiv = document.getElementById('content');

            rows.forEach((row, index) => {
                if (index === 0) return; // Ignorer l'en-tête

                const columns = row.split(',');
                const imageLink = columns[4].trim(); // lien direct déjà prêt
                const description = columns[1]?.trim() || "Pas de description";

                if (imageLink && imageLink.startsWith("https://drive.google.com/uc")) {
                    const div = document.createElement('div');
                    div.className = 'anomalie';

                    const img = document.createElement('img');
                    img.src = imageLink;
                    img.alt = 'Anomalie';

                    const p = document.createElement('p');
                    p.textContent = description;

                    div.appendChild(img);
                    div.appendChild(p);
                    contentDiv.appendChild(div);
                } else {
                    console.warn("Lien image invalide ou manquant à la ligne", index + 1);
                }
            });
        })
        .catch(error => console.error('Erreur lors du chargement du fichier CSV :', error));
</script>

</body>
</html>
