<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Images from Google Sheets</title>
    <style>
        img {
            max-width: 100%;
            height: auto;
        }
        .anomalie {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: #f9f9f9;
        }
        .anomalie p {
            font-size: 16px;
            color: #333;
        }
    </style>
</head>
<body>

<div id="content"></div>

<script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT_C2LQs5q5x3vlCnJYJhZnwHC31sEPMSP21XTw2fxszMe8no2Q2oLM3Fe7IqvftPI3_2-JlITASVlM/pub?gid=1768493748&single=true&output=csv';
    
    // Fetch the CSV data from the public Google Sheet URL
    fetch(sheetURL)
        .then(response => response.text())  // Get the CSV as plain text
        .then(csv => {
            const rows = csv.split('\n');  // Split the CSV into rows
            const contentDiv = document.getElementById('content');
            
            // Loop through the rows and create HTML elements for images and descriptions
            rows.forEach((row, index) => {
                if (index === 0) return;  // Skip the header row (if you have one)

                const columns = row.split(',');  // Split each row into columns

                const imageLink = columns[5]; // Column E (Image link)
                const description = columns[2]; // Column B (Description)

                if (imageLink && description) {  // Only process rows with image links
                    const anomalyDiv = document.createElement('div');
                    anomalyDiv.classList.add('anomalie');

                    // Create the image element
                    const img = document.createElement('img');
                    img.src = imageLink;  // Set the image source to the public image URL
                    img.alt = 'Anomalie';

                    // Create the description element
                    const descriptionPara = document.createElement('p');
                    descriptionPara.textContent = description;  // Set the description text

                    // Append the image and description to the anomaly div
                    anomalyDiv.appendChild(img);
                    anomalyDiv.appendChild(descriptionPara);

                    // Append the anomaly div to the content div
                    contentDiv.appendChild(anomalyDiv);
                }
            });
        })
        .catch(error => console.log('Error loading CSV data:', error));
</script>

</body>
</html>
